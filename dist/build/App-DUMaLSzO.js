const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["ConfigureTheView-vgQGbSfB.js","strapi-BdHBmQbs.js","strapi-D6821bIJ.css"])))=>i.map(i=>d[i]);
import{a as v,y as Le,ci as Re,v as _e,ck as Ue,f0 as V,cr as r,j as e,a1 as w,K as _,dg as $e,dj as Be,dk as De,f as F,fv as at,fw as Ae,fx as nt,r as C,dh as it,T as Y,dl as ot,dn as dt,dm as lt,fy as rt,O as B,aZ as Me,cs as we,l as A,fz as Pe,fA as ct,bK as Z,I as Q,bD as Ve,bL as ze,cy as h,h as Oe,fB as ut,fC as pt,di as K,fD as z,fE as ht,fF as gt,fG as ft,fH as xt,eJ as mt,ce as jt,fI as yt,fJ as Ct,H as k,d8 as bt,fK as vt,bG as Qe,cp as At,fL as H,fM as Mt,fN as wt,L as St,bv as Ft,bw as kt,fO as Tt,fP as It,fj as Et,fQ as Lt,fR as Rt,fS as _t,aL as ce,b as He,u as ee,dF as Se,fT as Ut,fU as $t,fV as Fe,fW as Bt,aQ as Ge,E as X,bX as Dt,aS as Ne,aK as Pt,eH as Vt,fX as zt,X as Ot,fY as Qt,fZ as Ht,f_ as Gt,f$ as Nt,g0 as Wt,g1 as qt,P as D,a5 as Kt,cC as Jt,g2 as Xt,g3 as Zt,g4 as J,g5 as Yt,g6 as es,g7 as ts,g8 as ss,g9 as as,ga as ns,bH as is,bo as os,gb as ds,cR as re,gc as ls,gd as rs,ge as cs,gf as us,f2 as ps,U as hs,V as ke,_ as gs}from"./strapi-BdHBmQbs.js";import{S as fs}from"./SearchInput-CeRJcw9O.js";import{u as xs}from"./useSettings-cNLf11v_.js";const ms=()=>{const{formatMessage:t}=v(),{toggleNotification:n}=Le(),s=Re(),{post:a}=_e(),o=Ue(({updates:g})=>a("/upload/actions/bulk-update",{updates:g}),{onSuccess(g){const{data:m}=g;m&&m.length>0&&(s.refetchQueries([V,"assets"],{active:!0}),s.refetchQueries([V,"asset-count"],{active:!0}),s.refetchQueries([V,"folders"],{active:!0})),n({type:"success",message:t({id:r("modal.edit.success-label"),defaultMessage:"Files have been successfully updated."})})}});return{...o,edit:g=>o.mutateAsync({updates:g})}},We=A(ft)`
  opacity: 0;
  z-index: 1;

  &:focus-within {
    opacity: 1;
  }
`,js=A(w)`
  background: ${({theme:t})=>t.colors.neutral0};
  border: 1px solid ${({theme:t})=>t.colors.neutral150};
  border-radius: ${({theme:t})=>t.borderRadius};

  &:hover {
    ${We} {
      opacity: 1;
    }
  }
`,ys=({asset:t})=>{const{formatMessage:n}=v(),s=O("AssetCardActions",i=>i.dispatch),a=O("AssetCardActions",i=>i.state),l=O("AssetCardActions",i=>i.onClose),{canUpdate:o,canCopyLink:c,canDownload:g}=Pe(),[m,f]=C.useState(!1),{removeAsset:j}=ct(()=>{}),x=async i=>{i?.preventDefault(),await j(t.id),s({type:"remove_uploaded_asset",payload:{id:t.id}}),a.uploadedAssets.length===1&&l()},y=i=>{i.stopPropagation()},M=i=>{i&&(s({type:"edit_uploaded_asset",payload:{editedAsset:i}}),f(!1))};return e.jsxs(We,{onClick:y,position:"end",children:[e.jsxs(Z.Root,{children:[e.jsx(Z.Trigger,{children:e.jsx(Q,{label:n({id:r("control-card.remove-selection"),defaultMessage:"Remove from selection"}),children:e.jsx(Ve,{})})}),e.jsx(ze,{onConfirm:x})]}),e.jsxs(h.Root,{open:m,onOpenChange:f,children:[e.jsx(h.Trigger,{children:e.jsx(Q,{label:n({id:r("control-card.edit"),defaultMessage:"Edit"}),children:e.jsx(Oe,{})})}),e.jsx(h.Content,{children:e.jsx(ut,{asset:{...t,isLocal:!1,folder:typeof t.folder=="number"?{id:t.folder}:t.folder},onClose:i=>M(i),canUpdate:o,canCopyLink:c,canDownload:g,omitFields:["caption","alternativeText"],omitActions:["replace"]})})]})]})},Cs=A.span`
  text-transform: uppercase;
`,bs=A(w)`
  position: relative;
  height: 100%;
  overflow: hidden;

  canvas,
  video {
    display: block;
    pointer-events: none;
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: ${({theme:t})=>t.borderRadius};
  }
`,vs=A(xt)`
  position: absolute;
  bottom: 0.5rem;
  right: 0.5rem;
`,As=A(w)`
  height: 100%;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;

  canvas,
  audio {
    display: block;
    max-width: 100%;
    max-height: 100%;
  }
`,Ms=({assetType:t,thumbnailUrl:n,assetUrl:s,asset:a})=>{const[l,o]=C.useState(),c=l?pt(l):void 0;switch(t){case z.Image:return e.jsx(K,{src:n,size:"S",alt:a.alternativeText||a.name});case z.Video:return e.jsx(K,{size:"S",children:e.jsxs(bs,{children:[e.jsx(gt,{url:s,mime:a.mime||"video/mp4",onLoadDuration:o,alt:a.alternativeText||a.name}),c&&e.jsx(vs,{children:c})]})});case z.Audio:return e.jsx(K,{size:"S",children:e.jsx(As,{children:e.jsx(ht,{url:s,alt:a.alternativeText||a.name})})});default:return e.jsx(K,{src:n,size:"S",alt:a.alternativeText||a.name})}},ws=A(Be)`
  display: flex;
  padding: ${({theme:t})=>t.spaces[2]} ${({theme:t})=>t.spaces[1]};
`,Ss=A($e)`
  width: 100%;
  height: 100%;
  border: none;
  box-shadow: none;
  border-radius: 0;
  padding: 0;
`,Fs=t=>{switch(t){case z.Image:return{id:r("settings.section.image.label"),defaultMessage:"IMAGE"};case z.Video:return{id:r("settings.section.video.label"),defaultMessage:"VIDEO"};case z.Audio:return{id:r("settings.section.audio.label"),defaultMessage:"AUDIO"};default:return{id:r("settings.section.doc.label"),defaultMessage:"DOC"}}},ks=({asset:t,onCaptionChange:n,onAltTextChange:s,wasAltTextChanged:a,wasCaptionChanged:l})=>{const{formatMessage:o}=v(),c=at(t.mime||""),g=Ae(t?.formats?.thumbnail?.url||t.url)||"",m=Ae(t.url)||"",f=t.height&&t.width?` - ${t.width}x${t.height}`:"",j=t.size?nt(t.size):"",x=`${f}${f&&j?" - ":""}${j}`,[y,M]=C.useState(t.caption||"");C.useEffect(()=>{n(y)},[y,n]);const[i,T]=C.useState(t.alternativeText||"");return C.useEffect(()=>{s(i)},[i,s]),e.jsx(js,{children:e.jsxs(_.Root,{children:[e.jsx(_.Item,{col:5,alignItems:"stretch",children:e.jsxs(Ss,{width:"100%",height:"100%",shadow:"none",borderRadius:0,padding:0,children:[e.jsxs(it,{style:{borderStyle:"none"},children:[e.jsx(ys,{asset:t}),e.jsx(Ms,{assetType:c,thumbnailUrl:g,assetUrl:m,asset:t})]}),e.jsx(ws,{children:e.jsxs(De,{width:"100%",children:[e.jsxs(F,{justifyContent:"space-between",alignItems:"start",children:[e.jsx(Y,{tag:"h2",children:e.jsx(ot,{tag:"span",children:t.name})}),e.jsx(dt,{children:o(Fs(c))})]}),e.jsx(F,{children:e.jsxs(lt,{children:[e.jsx(Cs,{children:rt(t.ext)}),x]})})]})})]})}),e.jsx(_.Item,{col:7,flex:1,children:e.jsxs(F,{direction:"column",height:"100%",alignItems:"stretch",flex:1,padding:4,gap:2,children:[e.jsxs(B.Root,{name:"caption",children:[e.jsx(F,{alignItems:"center",gap:2,children:e.jsx(B.Label,{children:o({id:r("form.input.label.file-caption"),defaultMessage:"Caption"})})}),e.jsx(Me,{value:y,onChange:S=>M(S.target.value),placeholder:o({id:r("form.input.placeholder.file-caption"),defaultMessage:"Enter caption"}),endAction:!l&&t.caption&&e.jsx(we,{width:"16px",height:"16px",fill:"#AC73E6"})})]}),e.jsxs(B.Root,{name:"alternativeText",hint:o({id:r("form.input.description.file-alt"),defaultMessage:"This text will be displayed if the asset can't be shown."}),children:[e.jsx(F,{alignItems:"center",gap:2,children:e.jsx(B.Label,{children:o({id:r("form.input.label.file-alt"),defaultMessage:"Alternative text"})})}),e.jsx(Me,{value:i,onChange:S=>T(S.target.value),placeholder:o({id:r("form.input.placeholder.file-alt"),defaultMessage:"Enter alternative text"}),endAction:!a&&t.alternativeText&&e.jsx(we,{width:"16px",height:"16px",fill:"#AC73E6"})}),e.jsx(B.Hint,{})]})]})})]})})},R=A(w)`
  background: linear-gradient(
    90deg,
    ${({theme:t})=>t.colors.neutral100} 25%,
    ${({theme:t})=>t.colors.neutral150} 50%,
    ${({theme:t})=>t.colors.neutral100} 75%
  );
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
  border-radius: ${({theme:t})=>t.borderRadius};
  width: ${({width:t})=>t||"100%"};
  height: ${({height:t})=>t||"1rem"};

  @keyframes loading {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }
`,Ts=({count:t=1})=>Array.from({length:t},(s,a)=>a).map(s=>e.jsx(w,{background:"neutral0",borderColor:"neutral150",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",marginBottom:4,children:e.jsxs(_.Root,{children:[e.jsx(_.Item,{col:5,alignItems:"stretch",children:e.jsxs($e,{height:"100%",width:"100%",borderStyle:"none",shadow:"none",borderRadius:0,padding:2,children:[e.jsx(w,{height:"150px",padding:2,children:e.jsx(R,{height:"100%"})}),e.jsx(Be,{style:{display:"flex",padding:"8px 4px"},children:e.jsxs(De,{width:"100%",children:[e.jsxs(F,{justifyContent:"space-between",alignItems:"start",marginBottom:1,children:[e.jsx(R,{width:"60%",height:"18px"}),e.jsx(R,{width:"40px",height:"16px"})]}),e.jsx(R,{width:"80%",height:"14px"})]})})]})}),e.jsx(_.Item,{col:7,flex:1,children:e.jsxs(F,{direction:"column",height:"100%",alignItems:"stretch",flex:1,padding:4,gap:2,children:[e.jsxs(w,{children:[e.jsx(R,{width:"60px",height:"16px",marginBottom:1}),e.jsx(R,{height:"32px"})]}),e.jsxs(w,{children:[e.jsx(R,{width:"100px",height:"16px",marginBottom:1}),e.jsx(R,{height:"32px"}),e.jsx(w,{marginTop:1,children:e.jsx(R,{width:"70%",height:"12px"})})]})]})})]})},s)),Te=A(h.Body)`
  padding: 0;
  display: flex;
  justify-content: center;

  [data-radix-scroll-area-viewport] {
    padding-top: ${({theme:t})=>t.spaces[6]};
    padding-bottom: ${({theme:t})=>t.spaces[6]};
    padding-left: ${({theme:t})=>t.spaces[7]};
    padding-right: ${({theme:t})=>t.spaces[7]};
  }
`,Is=A(bt)`
  & > button {
    display: none;
  }
`,Es=({onClose:t})=>{const{formatMessage:n}=v(),s=O("ModalContent",u=>u.state),a=O("ModalContent",u=>u.dispatch),l=O("ModalContent",u=>u.folderId),{upload:o}=yt(),{edit:c,isLoading:g}=ms(),[m,f]=C.useState(!1),[j,x]=C.useState(null),y=(u,p)=>{a({type:"set_uploaded_asset_caption",payload:{id:u,caption:p}})},M=(u,p)=>{a({type:"set_uploaded_asset_alt_text",payload:{id:u,altText:p}})},i=()=>{a({type:"set_uploaded_assets",payload:[]})},T=async()=>{if(s.hasUnsavedChanges){const u=s.uploadedAssets.filter(p=>(p.wasCaptionChanged||p.wasAltTextChanged)&&p.file.id);if(u.length>0){const p=u.map(b=>({id:b.file.id,fileInfo:{name:b.file.name,alternativeText:b.file.alternativeText??null,caption:b.file.caption??null,folder:typeof b.file.folder=="object"&&b.file.folder!==null?b.file.folder.id:b.file.folder}}));try{await c(p),a({type:"clear_unsaved_changes"})}catch(b){console.error("Failed to save asset changes:",b);return}}}i(),t()},S=()=>{i(),t()},te=async u=>{a({type:"set_assets_to_upload_length",payload:u.length}),x(null),f(!0);try{const p=u.map(U=>({...U,id:U.id?Number(U.id):void 0})),$=(await o(p,l)).map(U=>({...U,folder:l||U.folder}));a({type:"set_uploaded_assets",payload:$})}catch(p){console.error("Upload failed:",p),x(p instanceof Error?p:new Error("Upload failed"))}finally{f(!1)}};if(s.assetsToUploadLength===0)return e.jsx(h.Content,{children:e.jsx(Ct,{onClose:t,onAddAsset:te})});if(m||s.assetsToUploadLength>0&&s.uploadedAssets.length===0&&!j)return e.jsxs(h.Content,{children:[e.jsx(h.Header,{children:e.jsx(h.Title,{children:n({id:r("ai.modal.uploading.title"),defaultMessage:"Uploading and processing with AI..."})})}),e.jsx(Te,{children:e.jsx(Ts,{count:s.assetsToUploadLength})})]});const G=n({id:r("ai.modal.title"),defaultMessage:"{count, plural, one {# asset uploaded} other {# assets uploaded}}, review AI generated metadata"},{count:s.uploadedAssets.length});return j?e.jsxs(h.Content,{children:[e.jsx(h.Header,{children:e.jsx(h.Title,{children:G})}),e.jsx(h.Body,{children:e.jsx(Is,{closeLabel:"",variant:"danger",children:n({id:r("ai.modal.error"),defaultMessage:"Could not generate AI metadata for the uploaded files."})})}),e.jsxs(h.Footer,{children:[e.jsx(k,{onClick:S,variant:"tertiary",children:n({id:"cancel",defaultMessage:"Cancel"})}),e.jsx(k,{onClick:T,loading:g,children:n({id:"global.finish",defaultMessage:"Finish"})})]})]}):e.jsxs(h.Content,{children:[e.jsx(h.Header,{children:e.jsx(h.Title,{children:G})}),e.jsx(Te,{children:e.jsx(F,{gap:6,direction:"column",alignItems:"stretch",children:s.uploadedAssets.map(({file:u,wasCaptionChanged:p,wasAltTextChanged:b})=>e.jsx(ks,{asset:u,onCaptionChange:$=>u.id&&y(u.id,$),onAltTextChange:$=>u.id&&M(u.id,$),wasCaptionChanged:p,wasAltTextChanged:b},u.id))})}),e.jsxs(h.Footer,{children:[e.jsx(k,{onClick:S,variant:"tertiary",children:n({id:"cancel",defaultMessage:"Cancel"})}),e.jsx(k,{onClick:T,loading:g,children:n({id:"global.finish",defaultMessage:"Finish"})})]})]})},[Ls,O]=mt("AIUploadModalContext"),Rs=(t,n)=>jt(t,s=>{if(n.type==="set_uploaded_assets"&&(s.uploadedAssets=n.payload.map(a=>({file:a,wasCaptionChanged:!1,wasAltTextChanged:!1})),s.hasUnsavedChanges=!1),n.type==="set_assets_to_upload_length"&&(s.assetsToUploadLength=n.payload),n.type==="set_uploaded_asset_caption"){const a=s.uploadedAssets.find(l=>l.file.id===n.payload.id);a&&a.file.caption!==n.payload.caption&&(a.file.caption=n.payload.caption,a.wasCaptionChanged=!0,s.hasUnsavedChanges=!0)}if(n.type==="set_uploaded_asset_alt_text"){const a=s.uploadedAssets.find(l=>l.file.id===n.payload.id);a&&a.file.alternativeText!==n.payload.altText&&(a.file.alternativeText=n.payload.altText,a.wasAltTextChanged=!0,s.hasUnsavedChanges=!0)}if(n.type==="remove_uploaded_asset"&&(s.uploadedAssets=s.uploadedAssets.filter(a=>a.file.id!==n.payload.id)),n.type==="edit_uploaded_asset"){const a=s.uploadedAssets.findIndex(l=>l.file.id===n.payload.editedAsset.id);a!==-1&&(s.uploadedAssets[a]={file:n.payload.editedAsset,wasCaptionChanged:s.uploadedAssets[a].wasCaptionChanged,wasAltTextChanged:s.uploadedAssets[a].wasAltTextChanged})}n.type==="clear_unsaved_changes"&&(s.hasUnsavedChanges=!1,s.uploadedAssets.forEach(a=>{a.wasCaptionChanged=!1,a.wasAltTextChanged=!1}))}),_s=({open:t,onClose:n,folderId:s=null})=>{const[a,l]=C.useReducer(Rs,{uploadedAssets:[],assetsToUploadLength:0,hasUnsavedChanges:!1}),o=C.useCallback(()=>{l({type:"set_uploaded_assets",payload:[]}),n()},[n]);return e.jsx(Ls,{state:a,dispatch:l,folderId:s,onClose:o,children:e.jsx(h.Root,{open:t,onOpenChange:o,children:e.jsx(Es,{onClose:o})})})},Us=t=>{const{id:n}=vt();return e.jsx(w,{position:"relative",zIndex:2,children:e.jsx(Qe,{"aria-labelledby":`${n}-title`,...t})})},$s=()=>{const t=At(),{status:n,data:s}=xs(t);return t?{status:n,isEnabled:s?.aiMetadata}:{status:"success",isEnabled:!1}},Bs=(t,{pathname:n,query:s})=>{const a=[{id:null,label:{id:r("plugin.name"),defaultMessage:"Media Library"},href:t?H(n,s||{}):void 0}];return t?.parent&&typeof t?.parent!="number"&&t?.parent?.parent&&a.push([]),t?.parent&&typeof t.parent!="number"&&a.push({id:t.parent.id,label:t.parent.name,href:H(n,s||{},{folder:t.parent.id?.toString(),folderPath:t.parent.path})}),t&&a.push({id:t.id,label:t.name}),a},Ds=({selected:t,onSuccess:n})=>{const{formatMessage:s}=v(),{remove:a}=Mt(),l=async()=>{await a(t),n()};return e.jsxs(Z.Root,{children:[e.jsx(Z.Trigger,{children:e.jsx(k,{variant:"danger-light",size:"S",startIcon:e.jsx(Ve,{}),children:s({id:"global.delete",defaultMessage:"Delete"})})}),e.jsx(ze,{onConfirm:l})]})},Ps=()=>{const{formatMessage:t}=v(),{toggleNotification:n}=Le(),s=Re(),{post:a}=_e(),o=Ue(({destinationFolderId:g,filesAndFolders:m})=>{const f=m.reduce((j,x)=>{const{id:y,type:M}=x,i=M==="asset"?"fileIds":"folderIds";return j[i]||(j[i]=[]),j[i].push(y),j},{});return a("/upload/actions/bulk-move",{...f,destinationFolderId:g})},{onSuccess(g){const{data:{data:m}}=g;m?.files?.length>0&&(s.refetchQueries([V,"assets"],{active:!0}),s.refetchQueries([V,"asset-count"],{active:!0})),s.refetchQueries([V,"folders"],{active:!0}),n({type:"success",message:t({id:r("modal.move.success-label"),defaultMessage:"Elements have been moved successfully."})})}});return{...o,move:(g,m)=>o.mutateAsync({destinationFolderId:g,filesAndFolders:m})}},Vs=({onClose:t,selected:n=[],currentFolder:s})=>{const{formatMessage:a}=v(),{data:l,isLoading:o}=wt(),{move:c}=Ps();if(!l)return null;const g=async(f,{setErrors:j})=>{try{if(typeof f.destination!="string"){const x=f.destination.value;await c(x,n),t()}}catch(x){const y=It(x);if(y&&"errors"in y){const M=y.errors?.reduce((i,T)=>(i[T.values?.path?.length||"destination"]=T.defaultMessage,i),{});Et(M)||j(M)}}};if(o)return e.jsx(h.Content,{children:e.jsx(h.Body,{children:e.jsx(F,{justifyContent:"center",paddingTop:4,paddingBottom:4,children:e.jsx(St,{children:a({id:r("content.isLoading"),defaultMessage:"Content is loading."})})})})});const m={destination:{value:s?.id||"",label:s?.name||l[0].label}};return e.jsx(h.Content,{children:e.jsx(Ft,{validateOnChange:!1,onSubmit:g,initialValues:m,children:({values:f,errors:j,setFieldValue:x})=>e.jsxs(kt,{noValidate:!0,children:[e.jsx(h.Header,{children:e.jsx(h.Title,{children:a({id:r("modal.folder.move.title"),defaultMessage:"Move elements to"})})}),e.jsx(h.Body,{children:e.jsx(_.Root,{gap:4,children:e.jsx(_.Item,{xs:12,col:12,direction:"column",alignItems:"stretch",children:e.jsxs(B.Root,{id:"folder-destination",children:[e.jsx(B.Label,{children:a({id:r("form.input.label.folder-location"),defaultMessage:"Location"})}),e.jsx(Tt,{options:l,onChange:y=>{x("destination",y)},defaultValue:typeof f.destination!="string"?f.destination:void 0,name:"destination",menuPortalTarget:document.querySelector("body"),inputId:"folder-destination",error:j?.destination,ariaErrorMessage:"destination-error"}),j.destination&&e.jsx(Y,{variant:"pi",tag:"p",textColor:"danger600",children:j.destination})]})})})}),e.jsxs(h.Footer,{children:[e.jsx(h.Close,{children:e.jsx(k,{variant:"tertiary",name:"cancel",children:a({id:"cancel",defaultMessage:"Cancel"})})}),e.jsx(k,{type:"submit",loading:o,children:a({id:"modal.folder.move.submit",defaultMessage:"Move"})})]})]})})})},zs=({selected:t=[],onSuccess:n,currentFolder:s})=>{const{formatMessage:a}=v(),[l,o]=C.useState(!1),c=()=>{o(!1),n()};return e.jsxs(h.Root,{open:l,onOpenChange:o,children:[e.jsx(h.Trigger,{children:e.jsx(k,{variant:"secondary",size:"S",startIcon:e.jsx(Lt,{}),children:a({id:"global.move",defaultMessage:"Move"})})}),e.jsx(Vs,{currentFolder:s,onClose:c,selected:t})]})},Os=({selected:t=[],onSuccess:n,currentFolder:s})=>{const{formatMessage:a}=v(),l=t?.reduce(function(o,c){return c?.type==="folder"&&"files"in c&&c?.files&&"count"in c.files?o+c?.files?.count:o+1},0);return e.jsxs(F,{gap:2,paddingBottom:5,children:[e.jsx(Y,{variant:"epsilon",textColor:"neutral600",children:a({id:r("list.assets.selected"),defaultMessage:"{numberFolders, plural, one {1 folder} other {# folders}} - {numberAssets, plural, one {1 asset} other {# assets}} selected"},{numberFolders:t?.filter(({type:o})=>o==="folder").length,numberAssets:l})}),e.jsx(Ds,{selected:t,onSuccess:n}),e.jsx(zs,{currentFolder:s,selected:t,onSuccess:n})]})},Qs=({isFiltering:t,canCreate:n,canRead:s})=>t?{id:"list.assets-empty.title-withSearch",defaultMessage:"There are no elements with the applied filters"}:s?n?{id:"list.assets.empty-upload",defaultMessage:"Upload your first assets..."}:{id:"list.assets.empty",defaultMessage:"Media Library is empty"}:{id:"header.actions.no-permissions",defaultMessage:"No permissions to view"},Hs=({canCreate:t,isFiltering:n,canRead:s,onActionClick:a})=>{const{formatMessage:l}=v(),o=Qs({isFiltering:n,canCreate:t,canRead:s});return e.jsx(Rt,{icon:s?void 0:_t,action:t&&!n&&e.jsx(k,{variant:"secondary",startIcon:e.jsx(ce,{}),onClick:a,children:l({id:r("header.actions.add-assets"),defaultMessage:"Add new assets"})}),content:l({...o,id:r(o.id)})})},Gs=()=>{const[t,n]=C.useState(!1),{formatMessage:s}=v(),{trackUsage:a}=He(),[{query:l},o]=ee(),c=l?.filters?.$and||[],g=f=>{o({filters:{$and:f},page:1})},m=f=>{a("didFilterMediaLibraryElements",{location:"content-manager",filter:Object.keys(f[f.length-1])[0]}),o({filters:{$and:f},page:1})};return e.jsxs(Se.Root,{open:t,onOpenChange:n,children:[e.jsx(Se.Trigger,{children:e.jsx(k,{variant:"tertiary",startIcon:e.jsx(Ut,{}),size:"S",children:s({id:"app.utils.filters",defaultMessage:"Filters"})})}),e.jsx($t,{displayedFilters:Fe,filters:c,onSubmit:m,onToggle:n}),e.jsx(Bt,{appliedFilters:c,filtersSchema:Fe,onRemoveFilter:g})]})},Ns=({breadcrumbs:t=null,canCreate:n,folder:s=null,onToggleEditFolderDialog:a,onToggleUploadAssetDialog:l})=>{const{formatMessage:o}=v(),{pathname:c}=Ge(),[{query:g}]=ee(),m={...g,folder:s?.parent&&typeof s.parent!="number"&&s.parent.id?s.parent.id:void 0,folderPath:s?.parent&&typeof s.parent!="number"&&s.parent.path?s.parent.path:void 0};return e.jsx(X.Header,{title:o({id:r("plugin.name"),defaultMessage:"Media Library"}),subtitle:t&&typeof t!="boolean"&&s&&e.jsx(zt,{label:o({id:r("header.breadcrumbs.nav.label"),defaultMessage:"Folders navigation"}),breadcrumbs:t,currentFolderId:s?.id}),navigationAction:s&&e.jsx(Dt,{tag:Pt,startIcon:e.jsx(Vt,{}),to:`${c}?${Ne.stringify(m,{encode:!1})}`,children:o({id:r("header.actions.folder-level-up"),defaultMessage:"Back"})}),primaryAction:n&&e.jsxs(F,{gap:2,children:[e.jsx(k,{startIcon:e.jsx(ce,{}),variant:"secondary",onClick:a,children:o({id:r("header.actions.add-folder"),defaultMessage:"Add new folder"})}),e.jsx(k,{startIcon:e.jsx(ce,{}),onClick:l,children:o({id:r("header.actions.add-assets"),defaultMessage:"Add new assets"})})]})})},Ws=A(w)`
  height: 3.2rem;
  display: flex;
  align-items: center;
`,Ie=A(Y)`
  max-width: 100%;
`,Ee=A(w)`
  svg {
    path {
      fill: ${({theme:t})=>t.colors.neutral500};
    }
  }
`,qs=()=>{const t=Ot(),{canRead:n,canCreate:s,canUpdate:a,canCopyLink:l,canDownload:o,canConfigureView:c,isLoading:g}=Pe(),{isEnabled:m,status:f}=$s(),j=C.useRef(),{formatMessage:x}=v(),{pathname:y}=Ge(),{trackUsage:M}=He(),[{query:i},T]=ee(),S=!!(i._q||i.filters),[te,G]=Qt(us.view,J.GRID),u=te===J.GRID,{data:p,isLoading:b,error:$}=Ht({skipWhen:!n,query:i}),{data:U,isLoading:qe,error:Ke}=Gt({enabled:n&&p?.pagination?.page===1&&!Nt(i),query:i}),{data:se,isLoading:ue,error:Je}=Wt(i?.folder,{enabled:n&&!!i?.folder});Je?.name==="NotFoundError"&&t(y);const N=U?.map(d=>({...d,type:"folder",folderURL:H(y,i,{folder:d.id.toString(),folderPath:d.path}),isSelectable:a}))??[],I=N?.length||0,W=p?.results?.map(d=>({...d,type:"asset",isSelectable:a}))||[],E=W?.length??0,Xe=p?.pagination?.total,Ze=ue||qe||g||b||f==="loading",[ae,Ye]=C.useState(!1),[pe,he]=C.useState(!1),[ne,ie]=C.useState(void 0),[oe,ge]=C.useState(void 0),[L,{selectOne:de,selectAll:fe}]=qt(["type","id"],[]),xe=L?.length>0&&L?.length!==E+I,q=()=>Ye(d=>!d),me=({created:d=!1}={})=>{d&&i?.page!=="1"&&T({...i,page:1}),he(P=>!P)},je=(d,P)=>{d&&M("didSelectAllMediaLibraryElements"),fe(P)},ye=d=>{M("didSortMediaLibraryElements",{location:"upload",sort:d}),T({sort:d})},Ce=d=>{ge(d),he(!0)},et=d=>{ge(null),me(d),j.current&&j.current.focus()},be=d=>{d===E&&p?.pagination?.page===p?.pagination?.pageCount&&p?.pagination?.page&&p.pagination.page>1&&T({...i,page:p.pagination.page-1})},tt=()=>{fe(),be(L.length)};return Ze?e.jsx(D.Loading,{}):$||Ke||f==="error"?e.jsx(D.Error,{}):e.jsxs(X.Root,{children:[e.jsxs(D.Main,{children:[e.jsx(Ns,{breadcrumbs:ue?null:Bs(se,{pathname:y,query:i}),canCreate:s,onToggleEditFolderDialog:me,onToggleUploadAssetDialog:q,folder:se}),e.jsx(X.Action,{startActions:e.jsxs(e.Fragment,{children:[a&&u&&(E>0||I>0)&&e.jsx(Ws,{paddingLeft:2,paddingRight:2,background:"neutral0",hasRadius:!0,borderColor:"neutral200",children:e.jsx(Qe,{"aria-label":x({id:r("bulk.select.label"),defaultMessage:"Select all folders & assets"}),checked:xe?"indeterminate":(E>0||I>0)&&L.length===E+I,onCheckedChange:d=>je(d,[...W,...N])})}),n&&u&&e.jsx(Yt,{value:i?.sort,onChangeSort:ye}),n&&e.jsx(Gs,{})]}),endActions:e.jsxs(e.Fragment,{children:[c?e.jsx(Ee,{paddingTop:1,paddingBottom:1,children:e.jsx(Q,{tag:Kt,to:{pathname:`${y}/configuration`,search:Ne.stringify(i,{encode:!1})},label:x({id:"app.links.configure-view",defaultMessage:"Configure the view"}),children:e.jsx(Jt,{})})}):null,e.jsx(Ee,{paddingTop:1,paddingBottom:1,children:e.jsx(Q,{label:x(u?{id:r("view-switch.list"),defaultMessage:"List View"}:{id:r("view-switch.grid"),defaultMessage:"Grid View"}),onClick:()=>G(u?J.LIST:J.GRID),children:u?e.jsx(Xt,{}):e.jsx(Zt,{})})}),e.jsx(fs,{label:x({id:r("search.label"),defaultMessage:"Search for an asset"}),trackedEvent:"didSearchMediaLibraryElements",trackedEventDetails:{location:"upload"}})]})}),e.jsxs(X.Content,{children:[L.length>0&&e.jsx(Os,{currentFolder:se,selected:L,onSuccess:tt}),I===0&&E===0&&e.jsx(Hs,{canCreate:s,canRead:n,isFiltering:S,onActionClick:q}),n&&!u&&(E>0||I>0)&&e.jsx(es,{assetCount:E,folderCount:I,indeterminate:xe,onChangeSort:ye,onChangeFolder:(d,P)=>t(H(y,i,{folder:d.toString(),folderPath:P})),onEditAsset:ie,onEditFolder:Ce,onSelectOne:de,onSelectAll:je,rows:[...N,...W],selected:L,shouldDisableBulkSelect:!a,sortQuery:i?.sort??""}),n&&u&&e.jsxs(e.Fragment,{children:[I>0&&e.jsx(ts,{title:(S&&E>0||!S)&&x({id:r("list.folders.title"),defaultMessage:"Folders ({count})"},{count:I})||"",children:N.map(d=>{const st=!!L.filter(({type:le})=>le==="folder").find(le=>le.id===d.id),ve=H(y,i,{folder:d?.id.toString(),folderPath:d?.path});return e.jsx(_.Item,{col:3,direction:"column",alignItems:"stretch",children:e.jsx(ss,{ref:oe&&d.id===oe.id?j:void 0,ariaLabel:d.name,id:`folder-${d.id}`,to:ve,startAction:d.isSelectable?e.jsx(Us,{"data-testid":`folder-checkbox-${d.id}`,checked:st,onCheckedChange:()=>de(d)}):null,cardActions:e.jsx(Q,{label:x({id:r("list.folder.edit"),defaultMessage:"Edit folder"}),onClick:()=>Ce(d),children:e.jsx(Oe,{})}),children:e.jsx(as,{children:e.jsx(ns,{to:ve,children:e.jsxs(F,{tag:"h2",direction:"column",alignItems:"start",maxWidth:"100%",children:[e.jsxs(Ie,{fontWeight:"semiBold",textColor:"neutral800",ellipsis:!0,children:[d.name,e.jsx(is,{children:":"})]}),e.jsx(Ie,{tag:"span",textColor:"neutral600",variant:"pi",ellipsis:!0,children:x({id:r("list.folder.subtitle"),defaultMessage:"{folderCount, plural, =0 {# folder} one {# folder} other {# folders}}, {filesCount, plural, =0 {# asset} one {# asset} other {# assets}}"},{folderCount:d.children?.count,filesCount:d.files?.count})})]})})})})},`folder-${d.id}`)})}),E>0&&I>0&&e.jsx(w,{paddingTop:6,paddingBottom:4,children:e.jsx(os,{})}),E>0&&e.jsx(ds,{assets:W,onEditAsset:ie,onSelectAsset:de,selectedAssets:L.filter(({type:d})=>d==="asset"),title:(!S||S&&I>0)&&p?.pagination?.page===1&&x({id:r("list.assets.title"),defaultMessage:"Assets ({count})"},{count:Xe})||""})]}),e.jsxs(re.Root,{...p?.pagination,children:[e.jsx(re.PageSize,{}),e.jsx(re.Links,{})]})]})]}),ae&&(m?e.jsx(_s,{open:ae,onClose:q,folderId:i?.folder?Number(i.folder):null}):e.jsx(ls,{open:ae,onClose:q,trackedLocation:"upload",folderId:i?.folder})),pe&&e.jsx(rs,{open:pe,onClose:()=>et(),folder:oe,parentFolderId:i?.folder,location:"upload"}),ne&&e.jsx(cs,{onClose:d=>{d===null&&be(1),ie(void 0)},open:!!ne,asset:ne,canUpdate:a,canCopyLink:l,canDownload:o,trackedLocation:"upload"})]})},Ks=C.lazy(async()=>gs(()=>import("./ConfigureTheView-vgQGbSfB.js"),__vite__mapDeps([0,1,2])).then(t=>({default:t.ConfigureTheView}))),Ys=()=>{const{config:{isLoading:t,isError:n,data:s}}=ps(),[{rawQuery:a},l]=ee(),{formatMessage:o}=v(),c=o({id:r("plugin.name"),defaultMessage:"Media Library"});return C.useEffect(()=>{t||n||a||l({sort:s.sort,page:1,pageSize:s.pageSize})},[t,n,s,a,l]),t?e.jsx(D.Loading,{}):e.jsxs(D.Main,{children:[e.jsx(D.Title,{children:c}),a?e.jsx(C.Suspense,{fallback:e.jsx(D.Loading,{}),children:e.jsxs(hs,{children:[e.jsx(ke,{index:!0,element:e.jsx(qs,{})}),e.jsx(ke,{path:"configuration",element:e.jsx(Ks,{config:s})})]})}):null]})};export{Ys as Upload};
